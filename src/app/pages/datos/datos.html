<div class="container my-5" style="min-height: 75vh;">
    <div class="row justify-content-center">
        <div class="col-md-8">

            <!-- Formulario de Captura de Datos -->
            <div *ngIf="!envioExitoso" class="card shadow border-0 formulario-fondo">
                <div class="card-header bg-primary text-white py-3">
                    <h4 class="mb-0">Paso 2: Datos de Contacto</h4>
                    <small *ngIf="productoSeleccionado" class="text-white-50">
                        Versión elegida: <strong>{{ productoSeleccionado.nombre }}</strong>
                    </small>
                </div>

                <div class="card-body p-4">
                    <form #datosForm="ngForm" (ngSubmit)="enviarInformacion(datosForm)">

                        <div class="mb-3">
                            <label class="form-label fw-bold">Nombre Completo o Empresa <span
                                    class="text-danger">*</span></label>
                            <input type="text" class="form-control" name="nombre" [(ngModel)]="formData.nombre" required
                                minlength="3" #nombre="ngModel">
                            <div *ngIf="nombre.invalid && (nombre.dirty || nombre.touched)" class="text-danger small">
                                El nombre es obligatorio (mínimo 3 letras).
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Correo Electrónico <span
                                    class="text-danger">*</span></label>
                            <input type="email" class="form-control" name="email" [(ngModel)]="formData.email" required
                                email #email="ngModel">
                            <div *ngIf="email.invalid && (email.dirty || email.touched)" class="text-danger small">
                                Ingresa un correo electrónico válido.
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">Teléfono <span class="text-danger">*</span></label>
                                <input type="tel" class="form-control" name="telefono" [(ngModel)]="formData.telefono"
                                    required pattern="^[0-9]+$" minlength="8" #telefono="ngModel">
                                <div *ngIf="telefono.invalid && (telefono.dirty || telefono.touched)"
                                    class="text-danger small">
                                    Solo números, mínimo 8 dígitos.
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">Dirección</label>
                                <input type="text" class="form-control" name="direccion"
                                    [(ngModel)]="formData.direccion">
                            </div>
                        </div>

                        <div class="alert alert-info small">
                            Al enviar, tus datos serán guardados y un asesor te contactará.
                        </div>

                        <button type="submit" class="btn btn-success btn-lg w-100 mt-2 shadow"
                            [disabled]="datosForm.invalid || isSubmitting">
                            <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2" role="status"
                                aria-hidden="true"></span>
                            <span *ngIf="!isSubmitting">Confirmar y Enviar Solicitud</span>
                            <span *ngIf="isSubmitting">Enviando...</span>
                        </button>
                    </form>
                </div>
            </div>

            <!-- Mensaje de Éxito -->
            <div *ngIf="envioExitoso" class="alert alert-success p-5 text-center shadow exito-fondo">
                <h2 class="alert-heading mb-3">¡Solicitud Recibida! </h2>
                <p class="lead">Gracias por tu interés en el <strong>{{ productoSeleccionado?.nombre }}</strong>.</p>
                <hr>
                <p>Nuestro equipo de ventas se pondrá en contacto contigo en breve.</p>

                <button class="btn btn-primary mt-4" [routerLink]="['/']">
                    Volver al Inicio
                </button>
            </div>
            <br>
            <!-- Mensaje de Error de Navegación -->
            <div *ngIf="!productoSeleccionado && !envioExitoso" class="alert alert-warning text-center p-5 error-fondo">
                <h4>⚠️ No has seleccionado ninguna versión</h4>
                <p>Por favor, regresa al catálogo para elegir un producto.</p>
                <button class="btn btn-warning mt-3" [routerLink]="['/comprar']">Ir a Selección</button>
            </div>

        </div>
    </div>
</div>